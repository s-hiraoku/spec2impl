---
name: rules-generator
description: Generate .claude/rules/spec2impl.md with implementation environment instructions. Step 11 of spec2impl.
model: inherit
tools: Read, Write, Edit, Glob
---

# Rules Generator

Generate `.claude/rules/spec2impl.md` with implementation environment instructions.

**IMPORTANT: All content added to rules MUST be written in English.**

## Workflow

1. **Check** if `.claude/rules/` directory exists (create if needed)
2. **Generate** spec2impl rules content (in English)
3. **Write** to `.claude/rules/spec2impl.md`

## Execution

```typescript
// Check if .claude/rules/ directory exists
Glob(".claude/rules/")

// If directory doesn't exist, it will be created automatically by Write

// Generate and write spec2impl rules
Write(".claude/rules/spec2impl.md", generatedContent)
```

## Rules File Format

**All descriptions and content MUST be in English.**

```markdown
---
description: Implementation environment generated by spec2impl. Defines skills, agents, commands, and MCPs for this project.
---

# Implementation Environment

Generated by spec2impl from specification documents.

## Proactive Usage Instructions

**IMPORTANT: Use the following components proactively without waiting for user requests.**

### Skills (Auto-applied)
Skills are automatically applied during conversations. No explicit invocation needed.

| Skill | Description |
|-------|-------------|
| {name} | {description in English} |

### Agents (Use Proactively)
When working on tasks that match an agent's expertise, **proactively use the Task tool** to invoke the appropriate agent:

| Agent | When to Use Proactively |
|-------|-------------------------|
| {agent-name} | {trigger condition - e.g., "When reviewing code changes"} |

Example:
```typescript
// When you detect code that needs review, proactively invoke:
Task({
  subagent_type: "general-purpose",
  prompt: "Read .claude/agents/{agent-name}.md and execute. Target: {context}"
})
```

### Commands (Suggest Proactively)
Suggest relevant commands to the user when appropriate:

| Command | When to Suggest |
|---------|-----------------|
| /{command-name} | {trigger condition - e.g., "After code changes"} |

### MCPs (Use When Available)
MCPs provide additional capabilities. Use them proactively when available:

| MCP | Description | Token Required |
|-----|-------------|----------------|
| {name} | {description in English} | {token or None} |

## Downloaded Components

### Skills
| Skill | Description |
|-------|-------------|
| {name} | {description in English} |

### Agents
| Agent | Description | Proactive Trigger |
|-------|-------------|-------------------|
| {name} | {description in English} | {when to use proactively} |

### Commands
| Command | Description |
|---------|-------------|
| {name} | {description in English} |

### MCPs
| MCP | Description | Token Required |
|-----|-------------|----------------|
| {name} | {description in English} | {token or None} |

## Tasks Reference

See `docs/TASKS.md` for the full implementation task list.
```

## Key Differences from CLAUDE.md Approach

| Aspect | Rules File | CLAUDE.md |
|--------|------------|-----------|
| **Location** | `.claude/rules/spec2impl.md` | Root `CLAUDE.md` |
| **Scope** | Modular, isolated | Whole project |
| **Cleanup** | Delete single file | Edit/merge content |
| **Conflicts** | None with user content | Risk of overwriting |

## Benefits

- **Clean separation**: spec2impl content is isolated from user's CLAUDE.md
- **Easy cleanup**: Step 13 can simply delete the file instead of parsing markers
- **No conflicts**: User's CLAUDE.md remains untouched
- **Modular**: Rules file is loaded automatically alongside CLAUDE.md
